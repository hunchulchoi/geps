<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="ê³µì ì—°ê¸ˆ ì¢…í•©ì•ˆë‚´" />
        <meta name="author" content="ê³µë¬´ì› ì—°ê¸ˆê³µë‹¨" />
        <title>ê³µì ì—°ê¸ˆ ì¢…í•©ì•ˆë‚´</title>
        <meta property="og:title" content="ê³µì ì—°ê¸ˆ ì¢…í•©ì•ˆë‚´" />
        <meta property="og:description" content="Simple chatbox widget using Twitter Bootstrap 5" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://sistematico.github.io/bootstrap-chatbox" />
        <meta property="og:image" content="https://sistematico.github.io/bootstrap-chatbox/assets/img/logo-purple.png" />
        <link rel="icon" type="image/svg+xml" href="assets/img/logo-purple.svg" />
        <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
        <link rel="stylesheet" href="assets/css/main.css" />
    </head>
    <body>
        <header>
            <div class="container d-flex align-items-center justify-content-between p-3 mb-3 custom-border-bottom">
                <a href="/" class="d-flex align-items-center text-dark text-decoration-none">
                    <img class="logo" src="assets/img/logo.png" alt="ê³µë¬´ì› ì—°ê¸ˆê³µë‹¨" height="40" style="margin-top: 8px" />
                    <span class="ms-2 fs-4">ê³µì ì—°ê¸ˆ ì¢…í•©ì•ˆë‚´ í”„ë¡œê·¸ë¨</span>
                </a>

                <div>
                    <button onclick="chatStart()">ì²˜ìŒë¶€í„°</button>
                    <!-- <a class="btn shadow-none" href="https://github.com/sistematico/bootstrap-chatbox" role="button" style="color: #fff; background-color: #9a97f3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16" style="margin-top: -5px">
                            <path
                                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
                            />
                        </svg>
                        Github
                    </a> -->
                </div>
            </div>
        </header>
        <main>
            <div class="container">
                <div class="modal fade" tabindex="-1" id="modal">
                    <div class="modal-dialog modal-lg modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title"><img class="logo" src="assets/img/logo.png" alt="ê³µë¬´ì› ì—°ê¸ˆê³µë‹¨" height="40" />ê³µì ì—°ê¸ˆ ì¢…í•©ì•ˆë‚´ í”„ë¡œê·¸ë¨</h5>
                                <button class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-5"><img src="assets/img/geps_mascot.png" alt="ë¯¿ìŒì´ì™€ ë™í–‰ì´" width="100%" /></div>
                                    <div class="col-7">
                                        <p>ê¸°ì¡´ì˜ ìˆ˜ë™ì ì—ì„œ ë³´ë‹¤ ëŠ¥ë™ì ì´ê³  ê³ ê° ìƒí™©ë³„ ëŒ€ì‘ ì‚¬ë¡€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ì—¬ ê³µë‹¨ì˜ ì—°ê¸ˆì „ë¬¸ì„±ì„ í†µí•´ ê³ ê°ë‹˜ë“¤ê»˜ ê³µì ì—°ê¸ˆ ì¢…í•©ì•ˆë‚´ í”„ë¡œê·¸ë¨ì„ ì œì‘í–ˆìŠµë‹ˆë‹¤.</p>
                                        <p>í‡´ì§ì‚¬ìœ ì™€ ê¸‰ì—¬ì¢…ë¥˜ ë“± í–¥í›„ ê²½ë ¥ê²½ë¡œ ë“±</p>
                                        <p>ì—¬ëŸ¬ë¶„ì˜ í˜„ì¬(ë‹¨ê¸° ì˜ˆì •)ì™€ ë¯¸ë˜ ìƒí™©ì í•©í•œ ê³µì ì—°ê¸ˆ ë¶„ì–‘ì— ì „ë¬¸ì ì¸ ì•ˆë‚´ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ì¶©ë¶„í•œ ì—°ê¸ˆì œë„ í™œìš©ê³¼ ë…¸í›„ ì„¤ê³„ë¥¼ ì§€ì›í•˜ê³ ì ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.</p>
                                        <p>ê³ ê°ë‹˜ê»˜ì„œ ì…ë ¥í•˜ì‹  ê°’ì— ë”°ë¼ ê³µë‹¨ ë§ˆìŠ¤ì½”íŠ¸ ë¯¿ìŒì´ê°€ ì•ˆë‚´ë¥¼ ë„ì™€ ë“œë¦½ë‹ˆë‹¤.</p>
                                        <p>ê°ì‚¬í•©ë‹ˆë‹¤.</p>
                                    </div>
                                </div>
                                <p class="fs-4 text-warning">ğŸ™…ğŸ»â€â™€ï¸ ë³¸ ê°œì¸ë³„ ì…ë µê°’ ë“± ì •ë³´ëŠ” ìˆ˜ì§‘, ë³´ê´€ë˜ì§€ ì•Šìœ¼ë©°, ì„œë¹„ìŠ¤ ì¢…ë£Œí›„ ìë™ì ìœ¼ë¡œ íê¸°ë©ë‹ˆë‹¤.</p>
                            </div>
                            <div class="modal-footer">'<button class="btn btn-primary" data-bs-dismiss="modal">ë‹«ê¸°</button></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h>ëŒ€í™”í•˜ê¸°</h>
                    </div>
                    <div class="card-body" id="messages"></div>
                    <!-- <div class="card-footer">
                        <div class="input-group">
                            <input type="text" class="form-control shadow-none" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="button-addon2" />
                            <button class="btn btn-primary shadow-none border-0" type="button" id="button-addon2" style="background-color: #9a97f3">Send</button>
                        </div>
                    </div> -->
                </div>
            </div>
        </main>
        <footer class="py-3">
            <div class="container custom-border-top pt-3" style="color: #556677">
                (63568)ì œì£¼íŠ¹ë³„ìì¹˜ë„ ì„œê·€í¬ì‹œ ì„œí˜¸ì¤‘ì•™ë¡œ 63(ì„œí˜¸ë™)<br />
                Copyright(c) GEPS. All Right Reserved.
            </div>
        </footer>
        <script src="assets/js/bootstrap.bundle.min.js"></script>
        <script src="assets/js/moment-with-locales.min.js"></script>
        <script>
            //[...Array(10)].forEach((e, i) => loopNestedObj(divs));
            const modal = new bootstrap.Modal(document.querySelector('#modal'), {});

            document.onreadystatechange = () => modal.show();

            let current = 0;

            class Question {
                message;
                options;
                answer;
                constructor(message, options) {
                    this.message = message;
                    this.options = options;
                }
            }

            const questions = [
                new Question('1. í‡´ì§ì‚¬ìœ ', [{ text: 'ì •ë…„' }, { text: 'ëª…ì˜ˆ' }, { text: 'ì¼ë°˜(ì˜ì› ë©´ì§ ë“± ê³„ì•½ë§Œë£Œ í¬í•¨)' }]),
                new Question('2. ê³ ê°ë‹˜ì˜ ì¬ì§ê¸°ê°„ì€ ëª‡ ë…„ ì´ì‹ ê°€ìš”?(í•©ì‚°, ì‚¬ë³‘ ê¸°ê°„ë“± ê°€ì‚°ê¸°ê°„ í¬í•¨)', [{ text: '2016ë…„ ì´í›„ í‡´ì§ ê¸°ì¤€ 10ë…„ ì´ìƒ' }, { text: '2016ë…„ ì´í›„ í‡´ì§ ê¸°ì¤€ 10ë…„ ë¯¸ë§Œ' }]),
                new Question('3. ì–´ë–¤ ê¸‰ì—¬ë¥¼ ì„ íƒí•˜ì‹¤ ê±´ê°€ìš”?', [{ text: 'í‡´ì§ì—°ê¸ˆ' }, { text: 'í‡´ì§ì—°ê¸ˆê³µì œì¼ì‹œê¸ˆ' }, { text: 'í‡´ì§ì—°ê¸ˆì¼ì‹œê¸ˆ' }, { text: 'ë¯¸ìˆ˜ë ¹ ì˜ˆì •' }]),
            ];

            const chatStart = () => {
                document.getElementById('messages').innerHTML = '';

                current = 0;

                const _div = document.createElement('div');
                //_div.classList.add(classname);
                _div.classList.add('pb-4', 'text-center');
                document.getElementById('messages').appendChild(_div);
                const _span = document.createElement('span');

                _span.textContent = moment().locale('ko').format('YYYY MMMM Do a h:mm');
                _div.appendChild(_span);
                _div.appendChild(document.createElement('hr'));

                chat({ message: 'ê³ ê°ë‹˜ì˜ í˜„ì¬ ìƒí™©ì„ ì•Œë ¤ì£¼ì„¸ìš”' });

                chat(questions[current]);
            };

            const messagediv = (message, options) => {
                const third = document.createElement('div');
                const thirdClasses = ['flex-shrink-1', 'bg-light', 'rounded', 'py-2', 'px-3'];
                third.classList.add(...thirdClasses);

                const msgDiv = document.createElement('div');
                msgDiv.classList.add('font-weight-bold', 'mb-1');
                msgDiv.innerHTML = message.replaceAll('\n', '<br>');

                third.appendChild(msgDiv);

                if (options) {
                    //<div class="rounded bg-secondary bg-opacity-50 p-1">1.í‡´ì§ì‚¬ìœ </div>
                    options.forEach((o, index) => {
                        const option = document.createElement('div');
                        option.classList.add('rounded', 'bg-secondary', 'bg-opacity-10', 'p-1', 'mt-1', 'pointer');
                        option.name = 'option' + current;

                        const optionTxt = `${index + 1}. ${o.text}`;
                        option.onclick = (e) => {
                            answer(optionTxt);
                            e.target.classList.add('bg-opacity-25');
                            nextQuestion();
                        };
                        option.textContent = optionTxt;
                        third.appendChild(option);
                    });
                }

                return third;
            };

            const avatar = () => {
                const second = document.createElement('div');
                second.classList.add('mx-2');

                const avatar = document.createElement('img');
                avatar.src = 'assets/img/users/geps.png';
                avatar.classList.add('rounded-circle', 'me-1');
                avatar.width = 40;
                avatar.height = 40;
                avatar.alt = 'ë¯¿ìŒì´';

                second.appendChild(avatar);
                return second;
            };

            const timediv = (classname) => {
                const fourth = document.createElement('div');
                fourth.classList.add('ms-2');

                const timeDiv = document.createElement('div');
                timeDiv.classList.add('text-muted', 'small', 'text-nowrap', 'mt-2');
                timeDiv.textContent = moment().locale('ko').format('a h:mm');
                timeDiv.classList.add(classname);

                fourth.appendChild(timeDiv);
                return fourth;
            };

            const chat = (question) => {
                const first = document.createElement('div');
                first.classList.add('other', 'pb-4');
                document.getElementById('messages').appendChild(first);

                // ì•„ë°”íƒ€
                first.appendChild(avatar());

                // ë©”ì„¸ì§€
                const messageDiv = messagediv(question.message, question.options);
                messageDiv.classList.add('message-friend');
                first.appendChild(messageDiv);

                //ì‹œê°„
                first.appendChild(timediv('ms-2'));

                first.focus();
            };

            const answer = (message) => {
                const first = document.createElement('div');
                first.classList.add('own', 'pb-4');
                document.getElementById('messages').appendChild(first);

                // ë©”ì„¸ì§€
                const messageDiv = messagediv(message);
                messageDiv.classList.add('message');
                first.appendChild(messageDiv);

                //ì‹œê°„
                first.appendChild(timediv('me-2'));
            };

            const nextQuestion = () => {
                current++;
                if (current !== 3) {
                    chat(questions[current]);
                }

                if (current === 3) {
                    chat({ message: 'ê³ ê°ë‹˜ì˜ ì˜ˆìƒë˜ëŠ” ë¯¸ë˜ ìƒí™©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.' });
                    chat({
                        message: `ê¸‰ì—¬ìˆ˜ë ¹(í‡´ì§ì—°ê¸ˆ)
            í‡´ì§ì—°ê¸ˆì˜ ì‚°ì •ë°©ë²•
            êµìœ¡ìë£Œ í™œìš©
            í‡´ì§ì—°ê¸ˆì˜ ê°œì‹œì—°ë ¹
            êµìœ¡ìë£Œ í™œìš©

            ê°œì‹œê°€ ë°”ë¡œ ì•ˆë ê²½ìš° ì¡°ê¸°í‡´ì§ì—°ê¸ˆì„ í™œìš©í•´ë³´ì„¸ìš”!
            ì¡°ê¸°í‡´ì§ì—°ê¸ˆì˜ ê²½ìš° 1ë…„ ë‹¹ 5%ì”© ê°ì•¡í•©ë‹ˆë‹¤.

            (í‡´ì§ì†Œë“ì„¸)
            (ì—°ê¸ˆì†Œë“ì„¸)
            (ì—°ê¸ˆê³„ì¢Œë³€ê²½)`,
                    });
                }

                const container = document.querySelector('main .container');
                //const card = document.querySelector('#messages');
                //
                //container.animate([{ scrollTo: { top: 0 } }, { scrollTo: { top: container.scrollHeight } }], 400);
                //container.scrollTop = container.scrollHeight;
                container.scrollTo({ top: container.scrollHeight });

                console.log(container.getAnimations());

                //card.offsetTop = card.offsetHeight;

                console.log(container.scrollTop, container.scrollHeight, container);
                //console.dir(container);
                //console.dir(card);
                //console.log(card.offsetTop, card.offsetHeight);
            };

            chatStart();
        </script>
    </body>
</html>
